#!/bin/bash
echo "üîç Checking for large files in commit..."

MAX_SIZE=$((10 * 1024 * 1024))
FOUND_LARGE=0

git diff --cached --name-only | while read file; do
    if [ -f "$file" ]; then
        size=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file" 2>/dev/null || echo 0)
        
        if [ $size -gt $MAX_SIZE ]; then
            size_mb=$((size / 1024 / 1024))
            echo "‚ùå Large file detected: $file (${size_mb}MB)"
            FOUND_LARGE=1
        fi
    fi
done

if [ $FOUND_LARGE -eq 1 ]; then
    echo ""
    echo "üí° How to handle large files:"
    echo "1. Use Git LFS: git lfs track 'filename' && git add .gitattributes"
    echo "2. Remove from commit: git reset HEAD 'filename'"
    echo "3. Split file or use external storage"
    echo ""
    echo "To skip this check (not recommended): git commit --no-verify"
    exit 1
fi

echo "‚úÖ File size check passed"
exit 0
